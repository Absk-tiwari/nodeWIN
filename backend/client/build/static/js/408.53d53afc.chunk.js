"use strict";(self.webpackChunkpos=self.webpackChunkpos||[]).push([[408],{3408:(e,t,s)=>{s.r(t),s.d(t,{default:()=>v});var a=s(9379),n=s(9722),d=s(5989),c=s.n(d),l=s(5043),i=s(3003),r=s(3216),o=s(7574),u=s(6221),x=s(591),h=s(782),m=s(9904),b=s(2327),p=s(7550),j=s(7493),g=s(2679),y=s(7877),f=s(1052),A=s(3768),N=s(579);const v=function(){const{type:e}=(0,r.g)(),t=(0,i.wA)(),s=(0,l.useRef)(),[d,v]=(0,l.useState)("default"),[C,k]=(0,l.useState)(!1),[w,S]=(0,l.useState)(null),[I,D]=(0,l.useState)({catName:"",taxName:"",taxAmount:""}),{data:T,isSuccess:O,refetch:L}=(0,f.$f)(),{data:P,isSuccess:E,refetch:G}=(0,f.bw)(),[R]=(0,f.L0)(),[F,M]=(0,l.useState)([]),[z,H]=(0,l.useState)(!1),[_,Q]=(0,l.useState)(!1),Y=(0,l.useRef)(null),[B,U]=(0,l.useState)([]),[V,X]=(0,l.useState)({}),[K,W]=(0,l.useState)(e),$=e=>{e!==K&&W(e)},[q,J]=(0,l.useState)(!1),Z=e=>{const{index:t}=e.target.dataset;U(B.map(((s,n)=>n===parseInt(t)?(0,a.A)((0,a.A)({},s),{},{[e.target.name]:e.target.value}):s)))},ee=()=>J(!q),te=e=>X((0,a.A)((0,a.A)({},V),{},{[e.target.name]:e.target.value})),se=e=>{t({type:"LOADING"});const s=F[F.length-1];n.A.post("category/create",s).then((e=>{let{data:t}=e;t.status&&(A.Ay.success("Category added successfully!"),L())})).catch((()=>{})).finally((()=>t({type:"STOP_LOADING"})))},ae=(e,s)=>{const{index:a}=s.target.dataset;if(!e)return M(F.filter(((e,t)=>t!==parseInt(a))));window.confirm("Are you sure? Products associated with this category will also be deleted!")&&(t({type:"LOADING"}),n.A.get("category/remove/".concat(e)).then((s=>{let{data:n}=s;n.status?(M(F.filter(((e,t)=>t!==parseInt(a)))),A.Ay.success("Category removed!"),t(f.S5.util.updateQueryData("getPosProducts",void 0,(t=>t.products.filter((t=>t.category_id!==parseInt(e)))))),t(f.S5.util.updateQueryData("getProducts",void 0,(e=>e.products.filter((e=>e.catName!==F[a].name)))))):A.Ay.error("Couldn't remove category!")})).catch((()=>null)).finally((()=>t({type:"STOP_LOADING"}))))},ne=e=>{t({type:"LOADING"});const s=B[B.length-1];n.A.post("tax/create",s).then((e=>{let{data:t}=e;t.status?(A.Ay.success("Tax successfully added!"),G()):A.Ay.error("Something went wrong!")})).catch((()=>A.Ay.error("Something went wrong!"))).finally((()=>t({type:"STOP_LOADING"})))},de=(e,s)=>{const{index:a}=s.target.dataset;if(!e)return U(B.filter(((e,t)=>t!==parseInt(a))));window.confirm("Are you sure?")&&(t({type:"LOADING"}),n.A.get("tax/remove/".concat(e)).then((s=>{let{data:n}=s;n.status?(U(B.filter(((e,t)=>t!==parseInt(a)))),A.Ay.success("Tax removed!")):A.Ay.error("Couldn't remove tax!"),t(f.S5.util.updateQueryData("getTaxes",void 0,(t=>t.taxes.filter((t=>t.id!==parseInt(e))))))})).catch((()=>null)).finally((()=>t({type:"STOP_LOADING"}))))},ce=e=>{let{index:t}=e.target.dataset;M(F.map(((s,n)=>n===parseInt(t)?(0,a.A)((0,a.A)({},s),{},{[e.target.name]:e.target.value}):s)))},le=async e=>{let{id:t,status:s}=e.target.dataset,a=parseInt(s)?0:1;e.preventDefault();try{(await R({id:t,status:a}).unwrap()).status&&(e.target.checked=a)}catch(n){console.log("Exception on first sight:- "+n.message)}};(0,l.useEffect)((()=>(O&&M(T.categories),()=>null)),[O,T]),(0,l.useEffect)((()=>(E&&U(P.taxes),()=>null)),[E,P]);const[ie,re]=(0,l.useState)(null),[oe,ue]=(0,l.useState)({x:window.screen.availWidth/3,y:window.screen.availHeight/3}),[xe,he]=(0,l.useState)(!1),[me,be]=(0,l.useState)({x:0,y:0}),[pe,je]=(0,l.useState)(""),[ge,ye]=(0,l.useState)(1);(0,l.useEffect)((()=>{var e;null===(e=s.current)||void 0===e||e.setInput(pe)}),[pe]);const fe=()=>(0,N.jsx)(o.A,{isOpen:q,toggle:ee,children:(0,N.jsxs)(u.A,{onSubmit:se,children:[(0,N.jsx)(x.A,{toggle:ee,children:" Update Product "}),(0,N.jsx)(h.A,{children:(0,N.jsxs)(m.A,{children:[(0,N.jsx)(b.A,{children:(0,N.jsxs)(p.A,{children:[(0,N.jsx)(j.A,{children:" Name "}),(0,N.jsx)(g.A,{type:"text",name:"name",onChange:te})]})}),(0,N.jsx)(b.A,{children:(0,N.jsxs)(p.A,{children:[(0,N.jsx)(j.A,{children:" Revised Photo "}),(0,N.jsx)(g.A,{name:"color",type:"color",onChange:te})]})}),(0,N.jsx)(b.A,{children:(0,N.jsxs)(p.A,{children:[(0,N.jsx)(j.A,{children:" Status "}),(0,N.jsx)(g.A,{name:"status",type:"checkbox",onChange:te,defaultChecked:!0})]})})]})}),(0,N.jsx)(y.A,{children:(0,N.jsx)("button",{className:"btn btn-primary",type:"button",onClick:ee,children:"Close"})})]})});return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{className:"content-wrapper",children:(0,N.jsxs)("div",{className:"d-grid",style:{overflowY:"auto"},ref:Y,children:[(0,N.jsxs)("div",{className:"d-flex position-relative",children:[(0,N.jsx)("button",{className:"btn tablink","data-btn":"category",onClick:()=>$("categories"),"data-active":"categories"===K,style:{zIndex:8},children:" Categories "}),(0,N.jsx)("button",{className:"btn tablink","data-btn":"tax",onClick:()=>$("taxes"),"data-active":"taxes"===K,style:{borderTopLeftRadius:"0px",borderBottomLeftRadius:"0px",zIndex:8},children:"Taxes"})]}),(0,N.jsx)("div",{id:"category",className:"tabcontent ".concat("categories"===K?"d-block":"d-none"),ref:Y,children:(0,N.jsx)("div",{className:"col-lg-12 grid-margin stretch-card",children:(0,N.jsx)("div",{className:"card",children:(0,N.jsx)("div",{className:"card-body",children:(0,N.jsx)("div",{className:"table-responsive w-100 categoryTable",children:(0,N.jsxs)("table",{className:"table table-bordered w-100",children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{children:"S.No"}),(0,N.jsx)("th",{children:"Name"}),(0,N.jsx)("th",{children:"Color"}),(0,N.jsx)("th",{children:"Status"}),(0,N.jsxs)("th",{children:["Action",(0,N.jsx)("span",{className:"fa fa-plus btn-sm btn-rounded btn btn-success ms-4",title:"Create",onClick:()=>{M([...F,{name:"",color:"",status:!0}]),Y.current&&window.scrollTo(0,document.body.scrollHeight)},children:" New "})]})]})}),(0,N.jsx)("tbody",{children:F.map(((e,t)=>(0,N.jsxs)("tr",{children:[(0,N.jsxs)("td",{children:[" ",1+t," "]}),(0,N.jsxs)("td",{children:[" ",(0,N.jsx)(g.A,{name:"name",type:"text","data-index":t,onChange:ce,disabled:e.id&&z!==e.id,value:e.name,onClick:s=>{k("name"),re("cat"),je(e.name),S(t)}})," "]}),(0,N.jsxs)("td",{children:[" ",(0,N.jsx)(g.A,{type:"color",name:"color","data-index":t,onChange:ce,disabled:e.id&&z!==e.id,defaultValue:e.color})," "]}),(0,N.jsxs)("td",{children:[(0,N.jsx)("input",{type:"checkbox","data-id":e.id,"data-status":e.status,onChange:le,id:"btn"+e.id,name:"status",defaultChecked:e.status,className:"status"}),(0,N.jsx)("label",{htmlFor:"btn"+e.id}),(0,N.jsx)("div",{className:"plate"})]}),(0,N.jsx)("td",{children:e.id?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("button",{className:"btn btn-sm btn-primary ".concat(z===e.id&&"btn-success"),onClick:()=>{return z!==e.id?(t=e.id,H(t)):(e=>{const t=F.find((t=>t.id===e));n.A.post("category/update",t).then((e=>{let{data:t}=e;t.status&&(A.Ay.success(t.message),H(""),L())})).catch().finally()})(e.id);var t},children:z&&z===e.id?"Save":"Edit"}),(0,N.jsx)("button",{"data-index":t,className:"btn btn-sm btn-danger ms-3 delete",onClick:t=>ae(e.id,t),children:"Delete"})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("button",{className:"btn btn-sm btn-success",onClick:se,children:"Add"}),(0,N.jsx)("button",{"data-index":t,className:"btn btn-sm btn-light ms-3 delete",onClick:t=>ae(e.id,t),children:"Cancel"})]})})]},t)))})]})})})})})}),(0,N.jsx)("div",{id:"tax",className:"tabcontent ".concat("taxes"===K?"d-block":"d-none"),children:(0,N.jsx)("div",{className:"col-lg-12 grid-margin stretch-card",children:(0,N.jsx)("div",{className:"card",children:(0,N.jsx)("div",{className:"card-body",children:(0,N.jsx)("div",{className:"table-responsive w-100 taxTable",children:(0,N.jsxs)("table",{className:"table table-bordered w-100",children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{children:"S.No"}),(0,N.jsx)("th",{children:"Name"}),(0,N.jsx)("th",{children:"Amount"}),(0,N.jsx)("th",{children:"Status"}),(0,N.jsxs)("th",{children:["Action",(0,N.jsx)("span",{className:"mdi mdi-plus btn-sm btn-rounded btn btn-success ms-4","data-toggle":"modal","data-target":".addTaxes",title:"Create",onClick:()=>{U([...B,{name:"",amount:"",status:!0}]),Y.current&&window.scrollTo(0,document.body.scrollHeight)},children:" New "})]})]})}),(0,N.jsx)("tbody",{children:B.map(((e,t)=>(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:1+t}),(0,N.jsx)("td",{children:(0,N.jsx)(g.A,{"data-index":t,name:"name",value:e.name,onChange:Z,disabled:e.id&&_!==e.id,className:"input",onClick:s=>{k("name"),re("ct"),je(e.name),S(t)}})}),(0,N.jsx)("td",{children:(0,N.jsx)(g.A,{"data-index":t,name:"amount",defaultValue:e.amount,onChange:Z,disabled:e.id&&_!==e.id,className:"input",onClick:s=>{k("amount"),re("ct"),je(e.amount),S(t)}})}),(0,N.jsxs)("td",{children:[(0,N.jsx)("input",{type:"checkbox",style:{display:"none"},id:"btn-tax"+e.id,name:"status",defaultChecked:e.status,className:"status"}),(0,N.jsx)("label",{htmlFor:"btn-tax"+e.id}),(0,N.jsx)("div",{className:"plate"})]}),(0,N.jsx)("td",{children:e.id?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("button",{className:"btn btn-sm btn-primary ".concat(_===e.id&&"btn-success"),onClick:()=>{return _!==e.id?(t=e.id,Q(t)):(async e=>{const t=B.find((t=>t.id===e)),{data:s}=await n.A.post("/tax/update",t);s.status&&(G(),A.Ay.success("Tax successfully updated!"),Q(!1))})(e.id);var t},children:_&&_===e.id?"Save":"Edit"}),(0,N.jsx)("button",{className:"btn btn-sm btn-rounded btn-danger ms-3",onClick:t=>de(e.id,t),children:"Delete"})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("button",{className:"btn btn-sm btn-rounded btn-success",onClick:ne,children:" Add "}),(0,N.jsx)("button",{className:"btn btn-sm btn-rounded btn-light ms-3",onClick:t=>de(e.id,t),children:"Cancel"})]})})]},t)))})]})})})})})})]})}),(0,N.jsx)(fe,{}),C&&(0,N.jsx)("div",{className:"mt-4 position-fixed w-50",style:{zIndex:9999,top:60},children:(0,N.jsx)("div",{style:{overflow:"hidden",position:"relative"},onMouseMove:e=>{xe&&ue({x:e.clientX-me.x,y:e.clientY-me.y})},onMouseUp:()=>he(!1),children:(0,N.jsxs)("div",{style:{position:"fixed",top:"".concat(oe.y,"px"),left:"".concat(oe.x,"px"),cursor:xe?"grabbing":"grab",zIndex:1e3,width:700,resize:"both",overflow:"auto",transform:"scale(".concat(ge,")"),transformOrigin:"top center"},children:[(0,N.jsx)("div",{onMouseDown:e=>{he(!0),be({x:e.clientX-oe.x,y:e.clientY-oe.y})},style:{background:"#444",color:"#fff",padding:"5px 10px",cursor:"grab",textAlign:"center",borderRadius:"8px 8px 0 0"},children:"Hold To Drag"}),(0,N.jsx)(c(),{onChange:e=>{"cat"===ie?M(F.map(((t,s)=>s===parseInt(w)?(0,a.A)((0,a.A)({},t),{},{[C]:e}):t))):U(B.map(((t,s)=>s===parseInt(w)?(0,a.A)((0,a.A)({},t),{},{[C]:e}):t)))},onKeyPress:e=>{"{lock}"===e&&v((e=>"default"===e?"shift":"default"))},keyboardRef:e=>s.current=e,layout:{default:"amount"===C?["! @ # $ % ^ & * {bksp}","1 2 3 4 5 6 7 8 9 0"]:["q w e r t y u i o p","{lock} a s d f g h j k l","z x c v b n m {bksp}","{space}"],shift:["1 2 3 4 5 6 7 8 9 0","Q W E R T Y U I O P","{lock} A S D F G H J K L","Z X C V B N M {bksp}","{space}"]},display:{"{lock}":"Caps","{bksp}":"Backspace","{space}":"Space"},layoutName:d}),(0,N.jsxs)("div",{className:"bg-white d-flex board-navs",style:{justifyContent:"space-between",padding:"5px 20px"},children:[(0,N.jsx)("button",{className:"btn btn-light btn-rounded",onClick:()=>{s.current.clearInput()},style:{border:"1px solid gray"},children:"CLEAR"}),(0,N.jsx)("button",{style:{border:"1px solid"},className:"btn btn-light btn-rounded",onClick:()=>ye((e=>Math.max(e-.1,.5))),children:"-"}),(0,N.jsxs)("span",{children:[" Size: ",Math.round(100*ge),"% "]}),(0,N.jsx)("button",{style:{border:"1px solid"},className:"btn btn-light btn-rounded",onClick:()=>ye((e=>Math.min(e+.1,2))),children:"+"}),(0,N.jsx)("button",{onClick:()=>k(""),className:"btn btn-light btn-rounded",style:{border:"1px solid gray"},children:"HIDE"})]})]})})})]})}}}]);
//# sourceMappingURL=408.53d53afc.chunk.js.map