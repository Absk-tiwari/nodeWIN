"use strict";(self.webpackChunkpos=self.webpackChunkpos||[]).push([[802],{4802:(e,t,s)=>{s.r(t),s.d(t,{default:()=>E});var n=s(9379),r=s(5043),a=s(8613),i=s.n(a),c=s(5475),l=s(3003),o=s(9722),d=s(8595),h=s(3326),u=s(6221),p=s(591),x=s(782),m=s(5173),j=s.n(m),b=s(8139),f=s.n(b),g=s(6794),y=["className","cssModule","color","body","inverse","outline","tag","innerRef"];function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},v.apply(this,arguments)}function N(e,t){if(null==e)return{};var s,n,r=function(e,t){if(null==e)return{};var s,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)s=a[n],t.indexOf(s)>=0||(r[s]=e[s]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)s=a[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}var O={body:j().bool,className:j().string,color:j().string,cssModule:j().object,innerRef:j().oneOfType([j().object,j().string,j().func]),inverse:j().bool,outline:j().bool,tag:g.Wx};function w(e){var t=e.className,s=e.cssModule,n=e.color,a=e.body,i=e.inverse,c=e.outline,l=e.tag,o=void 0===l?"div":l,d=e.innerRef,h=N(e,y),u=(0,g.qO)(f()(t,"card",!!i&&"text-white",!!a&&"card-body",!!n&&"".concat(c?"border":"bg","-").concat(n)),s);return r.createElement(o,v({},h,{className:u,ref:d}))}w.propTypes=O;const S=w;var A=["className","cssModule","innerRef","tag"];function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},C.apply(this,arguments)}function k(e,t){if(null==e)return{};var s,n,r=function(e,t){if(null==e)return{};var s,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)s=a[n],t.indexOf(s)>=0||(r[s]=e[s]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)s=a[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}var I={className:j().string,cssModule:j().object,innerRef:j().oneOfType([j().object,j().string,j().func]),tag:g.Wx};function T(e){var t=e.className,s=e.cssModule,n=e.innerRef,a=e.tag,i=void 0===a?"div":a,c=k(e,A),l=(0,g.qO)(f()(t,"card-body"),s);return r.createElement(i,C({},c,{className:l,ref:n}))}T.propTypes=I;const D=T;var R=s(7877),F=s(2339),_=s(579);function E(){const e=(0,l.wA)(),t=(0,r.useRef)(),[s,a]=(0,r.useState)(0),[m,j]=(0,r.useState)([]),[b,f]=(0,r.useState)([]),[g,y]=(0,r.useState)(!1),[v,N]=(0,r.useState)(!1),[O,w]=(0,r.useState)(0),[A,C]=(0,r.useState)(1),[k,I]=(0,r.useState)(0),[T,E]=(0,r.useState)(""),[P,q]=(0,r.useState)(""),[L,G]=(0,r.useState)({from:"",to:""}),{isAdmin:M,currency:X,openingCash:z}=(0,l.d4)((e=>e.auth)),U=e=>G((0,n.A)((0,n.A)({},L),{},{[e.target.name]:e.target.value})),[Y,Z]=(0,r.useState)(!0),V=t=>{e({type:"LOADING"});const s=m[t.target.dataset.index];s?o.A.get("orders/view-order/".concat(s.id)).then((e=>{var t,r;let{data:a}=e;const{products:i,session:c}=a,l=JSON.parse(c.data);w(a.order.amount),I(a.order.payment_mode),C(s.session_id),E(null===(t=a.cashier)||void 0===t?void 0:t.email),W();let o=Object.values(i).map((e=>(0,n.A)((0,n.A)({},e),{},{stock:null===l||void 0===l?void 0:l.quantity[e.id]})));if(-1!==(null!==(r=null===l||void 0===l?void 0:l.products)&&void 0!==r?r:[]).indexOf("quick")){let e=o.reduce(((e,t)=>e+parseFloat(t.price*(null===l||void 0===l?void 0:l.quantity[t.id]))),0),t=a.order.amount-e;o=[...o,{name:"Others",price:t,id:"quick",stock:null===l||void 0===l?void 0:l.quantity.quick}]}f(o)})).catch().finally((()=>e({type:"STOP_LOADING"}))):console.log(s,t.target.dataset.index,m)},W=()=>y(!g),B=()=>N(!v);return(0,r.useEffect)((()=>(o.A.get("orders").then((e=>{let{data:t}=e;return j(t.orders)})).catch((()=>{})),()=>null)),[]),(0,r.useEffect)((()=>(i()(t.current).DataTable({paging:!0,searching:!0,info:!0,ordering:!0,pageLength:40}),()=>null)),[m]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{className:"content-wrapper",style:{width:"100%"},children:(0,_.jsx)("div",{className:"row",children:(0,_.jsxs)("div",{className:"col-lg-12 grid-margin stretch-card",children:[(0,_.jsx)("div",{className:"d-block position-absolute",style:{zIndex:9999,right:60},children:(0,_.jsx)("button",{className:"btn btn-success btn-rounded",onClick:B,children:" Generate Report "})}),(0,_.jsx)("div",{className:"card mt-5",children:(0,_.jsx)("div",{className:"card-body",children:(0,_.jsx)("div",{className:"table-responsive",children:(0,_.jsxs)("table",{className:"table table-hover table-bordered",ref:t,children:[(0,_.jsx)("thead",{children:(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{children:" Order ID "}),(0,_.jsx)("th",{children:" Session ID "}),(0,_.jsx)("th",{children:" Customer "}),(0,_.jsx)("th",{children:" Amount "}),(0,_.jsx)("th",{children:" Date "}),(0,_.jsx)("th",{children:" Transaction Type "}),M&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("th",{children:" Cashier "}),(0,_.jsx)("th",{children:" Action "})]})]})}),(0,_.jsxs)("tbody",{children:[m.map(((e,t)=>{var s,n;return(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{children:e.id}),(0,_.jsx)("td",{children:e.session_id}),(0,_.jsx)("td",{children:null===(s=e.customer)||void 0===s?void 0:s.name}),(0,_.jsx)("td",{children:X+" "+parseFloat(e.amount).toFixed(2)}),(0,_.jsx)("td",{children:(0,d.Y6)(e.created_at)}),(0,_.jsx)("td",{children:e.transaction_type}),M&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("td",{children:[" ",null===(n=e.cashier)||void 0===n?void 0:n.name," "]}),(0,_.jsx)("td",{children:(0,_.jsx)(c.N_,{type:"button","data-index":t,className:"text-decoration-none",onClick:V,children:" View "})})]})]},e.id)})),0===m.length&&(0,_.jsx)("tr",{children:(0,_.jsx)("td",{colSpan:9,children:(0,_.jsx)("p",{className:"text-danger text-center",children:" No orders yet "})})})]})]})})})})]})})}),(0,_.jsx)(h.A,{isOpen:v,children:(0,_.jsxs)(u.A,{onSubmit:async t=>{if(t.preventDefault(),P){console.log(z);const t={currency:X,today:Y,from:L.from,to:L.to,register_id:z.id,closing_cash:s};if("X"===P){e({type:"LOADING"});const{data:s}=await o.A.post("/orders/x-report",t);s.status?F.Ay.success(s.message):F.Ay.error(s.message),e({type:"STOP_LOADING"})}else if(window.confirm("This will reset all sessions for current cash registered!")){e({type:"LOADING"});const{data:s}=await o.A.post("orders/z-report",t);s.status?(window.electronAPI&&window.electronAPI.printReport(s.html),localStorage.setItem("cartSessions","[1]"),e({type:"RESET_KART"}),e({type:"DAY_CLOSE"}),F.Ay.success(s.message)):F.Ay.error(s.message),e({type:"STOP_LOADING"})}}},children:[(0,_.jsx)(p.A,{children:(0,_.jsx)("span",{className:"report-type",children:" Generate-Report"})}),(0,_.jsx)(x.A,{children:(0,_.jsx)(S,{children:(0,_.jsxs)(D,{children:[(0,_.jsx)("div",{className:"card-body asking",children:(0,_.jsxs)("div",{className:"container",style:{placeItems:"center"},children:[(0,_.jsx)("div",{className:"row",children:(0,_.jsx)("b",{children:" Select Type "})}),(0,_.jsxs)("div",{className:"row mt-2",children:[(0,_.jsx)("button",{className:"btn btn-rounded btn-success ms-3 ".concat(P&&"X"!==P?"btn-inactive":""),type:"button",onClick:()=>q("X"),style:{border:"5px solid #afe9f5"},children:" X-Report "}),(0,_.jsx)("button",{className:"btn btn-rounded btn-danger ms-3 ".concat(P&&"Z"!==P?"btn-inactive":""),type:"button",onClick:()=>q("Z"),style:{border:"5px solid #afe9f5"},children:" Z-Report "})]})]})}),(0,_.jsxs)("div",{className:"card-body the-report",style:{display:""===P&&"none"},children:[(0,_.jsx)("input",{type:"hidden",name:"type",defaultValue:P}),(0,_.jsxs)("div",{className:"row mb-2",children:[(0,_.jsx)("div",{className:"col-3",children:(0,_.jsx)("label",{htmlFor:"",children:" Today "})}),(0,_.jsx)("div",{className:"col-7",children:(0,_.jsx)("input",{type:"checkbox",name:"today",checked:Y,onChange:()=>Z(!Y)})})]}),(0,_.jsxs)("div",{className:"row mb-3",children:[(0,_.jsx)("div",{className:"col-3",style:{alignSelf:"center"},children:(0,_.jsx)("strong",{className:"mt-3",children:" From "})}),(0,_.jsx)("div",{className:"col-9",children:(0,_.jsx)("input",{type:"date",name:"from",className:"form-control",onChange:U,style:{float:"right"}})})]}),(0,_.jsxs)("div",{className:"row",children:[(0,_.jsx)("div",{className:"col-3",style:{alignSelf:"center"},children:(0,_.jsx)("strong",{className:"mt-3",children:" To "})}),(0,_.jsx)("div",{className:"col-9",children:(0,_.jsx)("input",{type:"date",name:"to",className:"form-control",onChange:U,style:{float:"right"}})})]}),"Z"===P&&(0,_.jsx)("div",{className:"row mt-3",children:(0,_.jsx)("div",{className:"col-12",children:(0,_.jsx)("input",{className:"input",type:"number",style:{border:"1px solid"},placeholder:"Closing cash in drawer "+X,required:!0,name:"closing_cash",onChange:e=>a(e.target.value)})})})]})]})})}),(0,_.jsxs)(R.A,{children:[(0,_.jsx)("button",{type:"button",className:"bg-light btn btn-rounded",onClick:B,children:"Close"}),(0,_.jsx)("button",{className:"bg-info btn text-white btn-rounded",children:" Generate "})]})]})}),(0,_.jsxs)(h.A,{isOpen:g,children:[(0,_.jsx)(p.A,{children:(0,_.jsx)("p",{style:{fontSize:"1.5rem"},children:"Order Details"})}),(0,_.jsx)(x.A,{children:(0,_.jsx)("div",{className:"col-lg-12",id:"receipt",children:(0,_.jsxs)("div",{className:"container",style:{backgroundColor:"white",paddingBottom:"10px",borderRadius:"15px"},children:[(0,_.jsx)("div",{className:"row",style:{display:"flex"},children:(0,_.jsxs)("div",{className:"d-grid text-center w-100",style:{justifyContent:"center"},children:[(0,_.jsxs)("p",{children:[" Served by ",(0,_.jsx)("b",{children:T})," "]}),"Session ",(0,_.jsxs)("h2",{className:"sessionID",children:["#",A]})]})}),(0,_.jsx)("div",{className:"row",children:(0,_.jsxs)("div",{className:"receipt",style:{width:"90%",background:"#fff",marginLeft:"5%"},children:[b.map(((e,t)=>(0,_.jsxs)("div",{className:"row mt-2 chosen-product",children:[(0,_.jsxs)("div",{className:"d-flex w-100",children:[(0,_.jsx)("b",{children:e.name}),(0,_.jsxs)("strong",{className:"price",children:[" Qty: ",e.stock]})]}),(0,_.jsx)("div",{className:"d-flex",children:(0,_.jsxs)("p",{className:"ms-3 mt-1",style:{fontFamily:"cursive"},children:[X+" "+e.price,"quick"!==e.id&&"/ Units"]})})]},t))),(0,_.jsxs)("div",{className:"",children:[(0,_.jsxs)("div",{className:"row d-flex mt-3",style:{justifyContent:"space-between"},children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("h2",{children:"TOTAL "}),(0,_.jsx)("p",{})]}),(0,_.jsxs)("div",{children:[(0,_.jsxs)("h2",{children:[" ",X+" "+parseFloat(O).toFixed(2)," "]}),(0,_.jsx)("p",{})]})]}),(0,_.jsxs)("div",{className:"row d-flex mt-0",style:{justifyContent:"space-between"},children:[(0,_.jsx)("div",{children:(0,_.jsxs)("small",{children:[" ",(0,d.x5)(k)," "]})}),(0,_.jsx)("div",{children:(0,_.jsxs)("small",{children:[" ",X+""+parseFloat(O).toFixed(2)," "]})})]})]})]})})]})})}),(0,_.jsx)(R.A,{children:(0,_.jsx)("button",{className:"btn btn-light btn-rounded",onClick:()=>W(!g),children:" Close "})})]})]})}i().fn.DataTable.ext.errMode="none"},8595:(e,t,s)=>{s.d(t,{C1:()=>d,E2:()=>c,N5:()=>i,Xz:()=>r,Y6:()=>h,iv:()=>o,sN:()=>l,x5:()=>a});s(8613);var n=s(2339);const r=(e,t)=>{for(var s=e.split(","),n=s[0].match(/:(.*?);/)[1],r=atob(s[s.length-1]),a=r.length,i=new Uint8Array(a);a--;)i[a]=r.charCodeAt(a);return new File([i],t,{type:n})},a=e=>{if(!e)return e;if(e.includes(" ")){let t="";return e.split(" ").forEach((e=>{t+=" "+e.charAt(0).toUpperCase()+e.slice(1)})),t}return e.charAt(0).toUpperCase()+e.slice(1)},i=e=>(0,n.Ay)(e,{icon:"\u26a0\ufe0f",style:{borderRadius:"10px",background:"#333",color:"#fff"}}),c=e=>{if(!e||"object"==typeof e)return e;3===(e=e.replace(/^#/,"")).length&&(e=e.split("").map((e=>e+e)).join(""));return{r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16)}},l=e=>{let t=c(e);if(void 0===t)return e;const{r:s,g:n,b:r}=t;return.299*s+.587*n+.114*r<128};function o(e,t){const s=[];if(!e)return[];arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&e.unshift({});for(let n=0;n<e.length;n+=t)s.push(e.slice(n,n+t));return s}const d=(e,t)=>{if((null===e||void 0===e?void 0:e.length)>t){return e.substring(0,t)+"..."}return e},h=e=>{const t=new Date(e),s=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),a=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0");String(t.getSeconds()).padStart(2,"0");return"".concat(s,"-").concat(n,"-").concat(r," ").concat(a,":").concat(i)}}}]);
//# sourceMappingURL=802.3caf5a8a.chunk.js.map