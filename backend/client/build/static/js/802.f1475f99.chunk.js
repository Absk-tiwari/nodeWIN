"use strict";(self.webpackChunkpos=self.webpackChunkpos||[]).push([[802],{4802:(e,t,r)=>{r.r(t),r.d(t,{default:()=>L});var n=r(9379),s=r(5043),i=r(8613),a=r.n(i),l=r(5475),o=r(3003),c=r(9722),d=r(8595),u=r(7574),h=r(6221),p=r(591),f=r(782),m=r(5173),x=r.n(m),y=r(8139),g=r.n(y),b=r(6794),j=["className","cssModule","color","body","inverse","outline","tag","innerRef"];function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},v.apply(this,arguments)}function N(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}var w={body:x().bool,className:x().string,color:x().string,cssModule:x().object,innerRef:x().oneOfType([x().object,x().string,x().func]),inverse:x().bool,outline:x().bool,tag:b.Wx};function S(e){var t=e.className,r=e.cssModule,n=e.color,i=e.body,a=e.inverse,l=e.outline,o=e.tag,c=void 0===o?"div":o,d=e.innerRef,u=N(e,j),h=(0,b.qO)(g()(t,"card",!!a&&"text-white",!!i&&"card-body",!!n&&"".concat(l?"border":"bg","-").concat(n)),r);return s.createElement(c,v({},u,{className:h,ref:d}))}S.propTypes=w;const O=S;var A=["className","cssModule","innerRef","tag"];function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},C.apply(this,arguments)}function k(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}var T={className:x().string,cssModule:x().object,innerRef:x().oneOfType([x().object,x().string,x().func]),tag:b.Wx};function I(e){var t=e.className,r=e.cssModule,n=e.innerRef,i=e.tag,a=void 0===i?"div":i,l=k(e,A),o=(0,b.qO)(g()(t,"card-body"),r);return s.createElement(a,C({},l,{className:o,ref:n}))}I.propTypes=T;const R=I;var P=r(7877),_=r(3768),D=r(6326),F=r(1939),E=r(579);function L(){const e=(0,s.useRef)(null),t=(0,o.wA)(),r=(0,s.useRef)(),[i]=(0,s.useState)(0),{setSession:m}=(0,D.S)(),[x,y]=(0,s.useState)({}),[g,b]=(0,s.useState)([]),[j,v]=(0,s.useState)([]),[N,w]=(0,s.useState)(!1),[S,A]=(0,s.useState)(!1),[C,k]=(0,s.useState)(0),[T,I]=(0,s.useState)(1),[L,M]=(0,s.useState)(0),[q,z]=(0,s.useState)(""),[G,W]=(0,s.useState)({from:"",to:""}),X={marginTop:".5rem",alignItems:"center",borderRadius:"10px",minHeight:"80px",border:"2px dashed",backgroundColor:"#fff",position:"relative",padding:"5px 10px"},{currency:U,openingCash:V}=(0,o.d4)((e=>e.auth)),Y=e=>(Z(!1),W((0,n.A)((0,n.A)({},G),{},{[e.target.name]:e.target.value}))),[H,Z]=(0,s.useState)(!0),B=()=>w(!N),J=()=>A(!S);return(0,s.useEffect)((()=>(c.A.get("orders").then((e=>{let{data:t}=e;return b(t.orders)})).catch((()=>{})),()=>null)),[]),(0,s.useEffect)((()=>(a()(r.current).DataTable({data:g,columns:[{title:"Order ID",data:"id"},{title:"Session ID",data:"session_id"},{title:"Cash Register-ID",data:null,render:e=>e.session.cash_register_id},{title:"Customer",data:null,render:e=>{var t,r;return"".concat(null!==(t=null===(r=e.customer)||void 0===r?void 0:r.name)&&void 0!==t?t:"")}},{title:"Amount",data:null,render:e=>U+" "+parseFloat(e.amount).toFixed(2)},{title:"Date",data:null,render:e=>(0,d.Y6)(e.created_at)},{title:"Transaction type",data:"transaction_type"},{title:"Cashier",data:null,render:e=>{var t;return null===(t=e.cashier)||void 0===t?void 0:t.name}},{title:"Action",data:null,render:e=>'<a class="text-decoration-none" type="button" data-index="'.concat(g.indexOf(e),'">View</a>')}],paging:!0,searching:!0,info:!0,ordering:!1,pageLength:40}),a()(r.current).on("click","a",(e=>(e=>{t({type:"LOADING"});const r=g[e.target.dataset.index];r&&(y(r),c.A.get("orders/view-order/".concat(r.id)).then((e=>{var t;let{data:s}=e;const{products:i,session:a}=s,l=JSON.parse(a.data);k(s.order.amount),M(s.order.payment_mode),I(r.session_id);let o=Object.values(i).map((e=>(0,n.A)((0,n.A)({},e),{},{stock:null===l||void 0===l?void 0:l.quantity[e.id]})));if(-1!==(null!==(t=null===l||void 0===l?void 0:l.products)&&void 0!==t?t:[]).indexOf("quick")){let e=o.reduce(((e,t)=>e+parseFloat(t.price*(null===l||void 0===l?void 0:l.quantity[t.id]))),0),t=s.order.amount-e;o=[...o,{name:"Others",price:t,id:"quick",stock:null===l||void 0===l?void 0:l.quantity.quick}]}v(o),B()})).catch((e=>_.Ay.error("Order details not found!"))).finally((()=>t({type:"STOP_LOADING"}))))})(e))),()=>a()(r.current).DataTable().destroy())),[g]),(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("div",{className:"content-wrapper",style:{width:"100%"},children:(0,E.jsx)("div",{className:"row",children:(0,E.jsxs)("div",{className:"col-lg-12 grid-margin stretch-card",children:[(0,E.jsx)("div",{className:"d-block position-absolute",style:{zIndex:9999,right:60},children:(0,E.jsx)("button",{className:"btn btn-success btn-rounded",onClick:J,children:" Generate Report "})}),(0,E.jsxs)("div",{className:"card mt-5",children:[(0,E.jsx)("div",{className:"card-header",children:(0,E.jsx)(l.N_,{to:"/reports",className:"btn btn-info btn-sm btn-rounded",children:"View Reports"})}),(0,E.jsx)("div",{className:"card-body",children:(0,E.jsxs)("div",{className:"table-responsive",children:[(0,E.jsx)("table",{className:"table table-hover table-bordered",ref:r}),0===g.length&&(0,E.jsx)("table",{className:"table position-absolute mr-3",style:{bottom:15,width:"98%"},children:(0,E.jsx)("tbody",{children:(0,E.jsx)("tr",{children:(0,E.jsx)("td",{colSpan:8,children:(0,E.jsx)("p",{className:"text-danger text-center",children:" No orders yet "})})})})})]})})]})]})})}),(0,E.jsx)(u.A,{isOpen:S,children:(0,E.jsxs)(h.A,{onSubmit:async e=>{if(e.preventDefault(),q){const e={currency:U,today:H,from:G.from,to:G.to,register_id:V.id,closing_cash:i};if("X"===q){t({type:"LOADING"});const{data:r}=await c.A.post("/orders/x-report",e);r.status?(_.Ay.success(r.message),window.electronAPI?window.electronAPI.printReport(r.html):(0,d.N5)("Printer not connected!")):_.Ay.error(r.message),t({type:"STOP_LOADING"})}else if(window.confirm("This will reset all sessions for current cash registered!")){t({type:"LOADING"});const{data:r}=await c.A.post("orders/z-report",e);r.status?(window.electronAPI?window.electronAPI.printReport(r.html):(0,d.N5)("Printer not connected!"),localStorage.setItem("cartSessions","[1]"),m([1]),t({type:"RESET_KART"}),t({type:"DAY_CLOSE"}),_.Ay.success(r.message)):_.Ay.error(r.message),t({type:"STOP_LOADING"})}}else(0,d.N5)("Select type of report!")},children:[(0,E.jsx)(p.A,{children:(0,E.jsx)("span",{className:"report-type",children:" Generate-Report"})}),(0,E.jsx)(f.A,{children:(0,E.jsx)(O,{children:(0,E.jsxs)(R,{children:[(0,E.jsx)("div",{className:"card-body asking",children:(0,E.jsxs)("div",{className:"container",style:{placeItems:"center"},children:[(0,E.jsx)("div",{className:"row",children:(0,E.jsx)("b",{children:" Select Type "})}),(0,E.jsxs)("div",{className:"row mt-2",children:[(0,E.jsx)("button",{className:"btn btn-rounded btn-success ms-3 ".concat(q&&"X"!==q?"btn-inactive":""),type:"button",onClick:()=>z("X"),style:{border:"5px solid #afe9f5"},children:" X-Report "}),(0,E.jsx)("button",{className:"btn btn-rounded btn-danger ms-3 ".concat(q&&"Z"!==q?"btn-inactive":""),type:"button",onClick:()=>z("Z"),style:{border:"5px solid #afe9f5"},children:" Z-Report "})]})]})}),(0,E.jsxs)("div",{className:"card-body the-report",style:{display:""===q&&"none"},children:[(0,E.jsx)("input",{type:"hidden",name:"type",defaultValue:q}),(0,E.jsxs)("div",{className:"row mb-2",children:[(0,E.jsx)("div",{className:"col-3",children:(0,E.jsx)("label",{htmlFor:"",children:" Today "})}),(0,E.jsx)("div",{className:"col-7",children:(0,E.jsx)("input",{type:"checkbox",name:"today",checked:H,onChange:()=>Z(!H)})})]}),(0,E.jsxs)("div",{className:"row mb-3",children:[(0,E.jsx)("div",{className:"col-3",style:{alignSelf:"center"},children:(0,E.jsx)("strong",{className:"mt-3",children:" From "})}),(0,E.jsx)("div",{className:"col-9",children:(0,E.jsx)("input",{type:"date",name:"from",className:"form-control",onChange:Y,style:{float:"right"}})})]}),(0,E.jsxs)("div",{className:"row",children:[(0,E.jsx)("div",{className:"col-3",style:{alignSelf:"center"},children:(0,E.jsx)("strong",{className:"mt-3",children:" To "})}),(0,E.jsx)("div",{className:"col-9",children:(0,E.jsx)("input",{type:"date",name:"to",className:"form-control",onChange:Y,style:{float:"right"}})})]})]})]})})}),(0,E.jsxs)(P.A,{children:[(0,E.jsx)("button",{type:"button",className:"bg-light btn btn-rounded",onClick:J,children:"Close"}),(0,E.jsx)("button",{className:"bg-info btn text-white btn-rounded",children:" Generate "})]})]})}),(0,E.jsxs)(u.A,{isOpen:N,children:[(0,E.jsx)(p.A,{children:(0,E.jsx)("p",{style:{fontSize:"1.5rem"},children:"Order Details"})}),(0,E.jsx)(f.A,{ref:e,children:(0,E.jsx)("div",{style:{width:"100%"},children:(0,E.jsxs)("div",{className:"container",style:{backgroundColor:"white",paddingBottom:"10px",borderRadius:"15px",fontSize:"larger"},children:[(0,E.jsx)("div",{style:{display:"flex",fontSize:"larger"},children:(0,E.jsxs)("div",{style:{justifyContent:"center",width:"100%",textAlign:"center",display:"grid"},children:[(0,E.jsx)("img",{src:F,alt:"",style:{filter:"grayscale(1)"},height:140}),(0,E.jsxs)("h2",{children:["#",x.cash_register_id+":"+T]})]})}),(0,E.jsx)("div",{style:{marginTop:15},children:(0,E.jsxs)("div",{style:{width:"100%",background:"#fff"},children:[j.map(((e,t)=>(0,E.jsxs)("div",{className:"",style:X,children:[(0,E.jsxs)("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[(0,E.jsx)("b",{style:{fontSize:"larger",maxWidth:"85%"},children:e.name}),(0,E.jsxs)("strong",{className:"price",children:[" Qty: ",e.stock]})]}),(0,E.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,E.jsxs)("p",{style:{fontSize:"larger",fontWeight:900,marginTop:"0.5rem"},children:[U+" "+e.price,"quick"!==e.id&&"/ Units"]}),(0,E.jsx)("p",{style:{fontSize:"larger",fontWeight:900,marginTop:"0.5rem"},children:U+parseFloat(e.price*e.stock).toFixed(2)})]})]},t))),(0,E.jsxs)("div",{children:[(0,E.jsxs)("div",{style:{display:"flex",justifyContent:"end",marginTop:"1.4rem"},children:[(0,E.jsx)("div",{children:(0,E.jsx)("h2",{children:" TOTAL "})}),(0,E.jsxs)("div",{style:{marginLeft:15},children:[(0,E.jsxs)("h2",{children:[" ",U+" "+parseFloat(C).toFixed(2)," "]}),(0,E.jsx)("p",{})]})]}),(0,E.jsxs)("div",{style:{display:"flex",justifyContent:"end",width:"100%"},children:[(0,E.jsx)("div",{children:(0,E.jsxs)("b",{children:[" ",(0,d.x5)(L)," "]})}),(0,E.jsx)("div",{style:{marginLeft:15},children:(0,E.jsxs)("b",{children:[" ",U+""+parseFloat(C).toFixed(2)," "]})})]}),(0,E.jsx)("div",{className:"",style:{justifyContent:"end",display:"flex",width:"100%"},children:(0,E.jsx)("small",{children:"\u260e: 070-3563062"})})]}),(0,E.jsx)("center",{children:(0,E.jsx)("b",{children:"Thank you! Visit Again!"})})]})})]})})}),(0,E.jsxs)(P.A,{children:[(0,E.jsx)("button",{className:"btn btn-light btn-rounded",onClick:()=>B(!N),children:" Close "}),(0,E.jsx)("button",{type:"button",className:"btn btn-primary btn-rounded",onClick:async t=>{const r=e.current;if(!r)return _.Ay.error("Sorry can't go further...");try{window.electronAPI?window.electronAPI.printContent({html:r.innerHTML,id:x.cash_register_id+":"+T}):(0,d.N5)("Printer not connected!")}catch(n){console.error("Error capturing image:",n)}},children:" Print "})]})]})]})}a().fn.DataTable.ext.errMode="none"},8595:(e,t,r)=>{r.d(t,{C1:()=>d,E2:()=>l,N5:()=>a,Xz:()=>s,Y6:()=>u,iv:()=>c,sN:()=>o,x5:()=>i});r(8613);var n=r(3768);const s=(e,t)=>{for(var r=e.split(","),n=r[0].match(/:(.*?);/)[1],s=atob(r[r.length-1]),i=s.length,a=new Uint8Array(i);i--;)a[i]=s.charCodeAt(i);return new File([a],t,{type:n})},i=e=>{if(!e)return e;if(e.includes(" ")){let t="";return e.split(" ").forEach((e=>{t+=" "+e.charAt(0).toUpperCase()+e.slice(1)})),t}return e.charAt(0).toUpperCase()+e.slice(1)},a=e=>(0,n.Ay)(e,{icon:"\u26a0\ufe0f",style:{borderRadius:"10px",background:"#333",color:"#fff"}}),l=e=>{if(!e||"object"==typeof e)return e;3===(e=e.replace(/^#/,"")).length&&(e=e.split("").map((e=>e+e)).join(""));return{r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16)}},o=e=>{let t=l(e);if(void 0===t)return e;const{r:r,g:n,b:s}=t;return.299*r+.587*n+.114*s<128};function c(e,t){const r=[];if(!e)return[];arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&e.unshift({});for(let n=0;n<e.length;n+=t)r.push(e.slice(n,n+t));return r}const d=(e,t)=>{if((null===e||void 0===e?void 0:e.length)>t){return e.substring(0,t)+"..."}return e},u=e=>{const t=new Date(e),r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),a=String(t.getMinutes()).padStart(2,"0");String(t.getSeconds()).padStart(2,"0");return"".concat(r,"-").concat(n,"-").concat(s," ").concat(i,":").concat(a)}},1939:(e,t,r)=>{e.exports=r.p+"static/media/logo.2d2e09f65e21f53b1f9f.png"}}]);
//# sourceMappingURL=802.f1475f99.chunk.js.map