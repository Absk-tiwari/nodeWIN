"use strict";(self.webpackChunkpos=self.webpackChunkpos||[]).push([[802],{4802:(e,t,r)=>{r.r(t),r.d(t,{default:()=>L});var n=r(9379),s=r(5043),a=r(8613),i=r.n(a),o=r(5475),l=r(3003),c=r(9722),d=r(8595),u=r(7574),p=r(6221),h=r(591),g=r(782),m=r(5173),x=r.n(m),b=r(8139),f=r.n(b),y=r(6794),j=["className","cssModule","color","body","inverse","outline","tag","innerRef"];function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},v.apply(this,arguments)}function N(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}var w={body:x().bool,className:x().string,color:x().string,cssModule:x().object,innerRef:x().oneOfType([x().object,x().string,x().func]),inverse:x().bool,outline:x().bool,tag:y.Wx};function S(e){var t=e.className,r=e.cssModule,n=e.color,a=e.body,i=e.inverse,o=e.outline,l=e.tag,c=void 0===l?"div":l,d=e.innerRef,u=N(e,j),p=(0,y.qO)(f()(t,"card",!!i&&"text-white",!!a&&"card-body",!!n&&"".concat(o?"border":"bg","-").concat(n)),r);return s.createElement(c,v({},u,{className:p,ref:d}))}S.propTypes=w;const A=S;var O=["className","cssModule","innerRef","tag"];function k(){return k=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},k.apply(this,arguments)}function C(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}var T={className:x().string,cssModule:x().object,innerRef:x().oneOfType([x().object,x().string,x().func]),tag:y.Wx};function I(e){var t=e.className,r=e.cssModule,n=e.innerRef,a=e.tag,i=void 0===a?"div":a,o=C(e,O),l=(0,y.qO)(f()(t,"card-body"),r);return s.createElement(i,k({},o,{className:l,ref:n}))}I.propTypes=T;const F=I;var R=r(7877),D=r(3768),P=r(6326),_=r(1939),E=r(579);function L(){const e=(0,s.useRef)(null),t=(0,l.wA)(),r=(0,s.useRef)(),[a]=(0,s.useState)(0),{setSession:m}=(0,P.S)(),[x,b]=(0,s.useState)({}),[f,y]=(0,s.useState)([]),[j,v]=(0,s.useState)([]),[N,w]=(0,s.useState)(!1),[S,O]=(0,s.useState)(!1),[k,C]=(0,s.useState)(0),[T,I]=(0,s.useState)(1),[L,M]=(0,s.useState)(0),[z,q]=(0,s.useState)(""),[G,H]=(0,s.useState)({from:"",to:""}),V={marginTop:".5rem",alignItems:"center",borderRadius:"10px",minHeight:20,border:"2px dashed",backgroundColor:"#fff",position:"relative",padding:"0px"},{currency:W,openingCash:X,categories:U}=(0,l.d4)((e=>e.auth)),Y=e=>{B(!1),H((0,n.A)((0,n.A)({},G),{},{[e.target.name]:e.target.value}))},[Z,B]=(0,s.useState)(!0),J=()=>w(!N),K=()=>O(!S);return(0,s.useEffect)((()=>(c.A.get("orders").then((e=>{let{data:t}=e;return y(t.orders)})).catch((()=>{})),()=>null)),[]),(0,s.useEffect)((()=>(i()(r.current).DataTable({data:f,columns:[{title:"Order ID",data:"id"},{title:"Date",data:null,render:e=>(0,d.Y6)(e.created_at)},{title:"Cash Register-ID",data:null,render:e=>e.session.cash_register_id},{title:"Session ID",data:"session_id"},{title:"Amount",data:null,render:e=>W+" "+parseFloat(e.amount).toFixed(2)},{title:"Cashier",data:null,render:e=>{var t;return null===(t=e.cashier)||void 0===t?void 0:t.name}},{title:"Action",data:null,render:e=>'<a class="text-decoration-none" type="button" data-index="'.concat(f.indexOf(e),'">View</a>')}],rowCallback:function(e,t){t.register.status||i()(e).addClass("activated")},paging:!0,searching:!0,info:!0,ordering:!1,pageLength:40}),console.log(f),i()(r.current).on("click","a",(e=>(e=>{t({type:"LOADING"});const r=f[e.target.dataset.index];r&&(console.log(r),b(r),c.A.get("orders/view-order/".concat(r.id)).then((e=>{var t;let{data:s}=e;const{products:a,session:i}=s,o=JSON.parse(i.data);C(s.order.amount),M(s.order.payment_mode),I(r.session_id);let l=Object.values(a).map((e=>(0,n.A)((0,n.A)({},e),{},{stock:null===o||void 0===o?void 0:o.quantity[e.id]})));if(-1!==(null!==(t=null===o||void 0===o?void 0:o.products)&&void 0!==t?t:[]).indexOf("quick")){let e=l.reduce(((e,t)=>e+parseFloat(t.price*(null===o||void 0===o?void 0:o.quantity[t.id]))),0),t=s.order.amount-e;l=[...l,{name:"Others",price:t,id:"quick",stock:null===o||void 0===o?void 0:o.quantity.quick}]}v(l.map((e=>{var t,r;return U[e.category_id]&&(e.isVeg=!0),e.prices=null!==(t=o.price)&&void 0!==t?t:{},e.units=null!==(r=o.unit)&&void 0!==r?r:{},e}))),J()})).catch((e=>D.Ay.error("Order details not found!"))).finally((()=>t({type:"STOP_LOADING"}))))})(e))),()=>i()(r.current).DataTable().destroy())),[f]),(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("div",{className:"content-wrapper",style:{width:"100%"},children:(0,E.jsx)("div",{className:"row",children:(0,E.jsxs)("div",{className:"col-lg-12 grid-margin stretch-card",children:[(0,E.jsx)("div",{className:"d-block position-absolute",style:{zIndex:1,right:60},children:(0,E.jsx)("button",{className:"btn btn-success btn-rounded",onClick:K,children:" Generate Report "})}),(0,E.jsxs)("div",{className:"card mt-5",children:[(0,E.jsx)("div",{className:"card-header",children:(0,E.jsx)(o.N_,{to:"/reports",className:"btn btn-info btn-sm btn-rounded",children:"View Reports"})}),(0,E.jsx)("div",{className:"card-body",children:(0,E.jsxs)("div",{className:"table-responsive",children:[(0,E.jsx)("table",{className:"table table-hover table-bordered",ref:r}),0===f.length&&(0,E.jsx)("table",{className:"table position-absolute mr-3",style:{bottom:15,width:"98%"},children:(0,E.jsx)("tbody",{children:(0,E.jsx)("tr",{children:(0,E.jsx)("td",{colSpan:8,children:(0,E.jsx)("p",{className:"text-danger text-center",children:" No orders yet "})})})})})]})})]})]})})}),(0,E.jsx)(u.A,{isOpen:S,children:(0,E.jsxs)(p.A,{onSubmit:async e=>{if(e.preventDefault(),z){const e={currency:W,today:Z,from:G.from,to:G.to,register_id:X.id,closing_cash:a};if("X"===z){t({type:"LOADING"});const{data:r}=await c.A.post("/orders/x-report",e);r.status?(D.Ay.success(r.message),window.electronAPI?window.electronAPI.printReport(r.html):(0,d.N5)("Printer not connected!")):D.Ay.error(r.message),t({type:"STOP_LOADING"})}else if(window.confirm("This will reset all sessions for current cash registered!")){t({type:"LOADING"});const{data:r}=await c.A.post("orders/z-report",e);r.status?(window.electronAPI?window.electronAPI.printReport(r.html):(0,d.N5)("Printer not connected!"),localStorage.setItem("cartSessions","[1]"),m([1]),t({type:"RESET_KART"}),t({type:"DAY_CLOSE"}),D.Ay.success(r.message)):D.Ay.error(r.message),t({type:"STOP_LOADING"})}}else(0,d.N5)("Select type of report!")},children:[(0,E.jsx)(h.A,{children:(0,E.jsx)("span",{className:"report-type",children:" Generate-Report"})}),(0,E.jsx)(g.A,{children:(0,E.jsx)(A,{children:(0,E.jsxs)(F,{children:[(0,E.jsx)("div",{className:"card-body asking",children:(0,E.jsxs)("div",{className:"container",style:{placeItems:"center"},children:[(0,E.jsx)("div",{className:"row",children:(0,E.jsx)("b",{children:" Select Type "})}),(0,E.jsxs)("div",{className:"row mt-2",style:{width:"122%"},children:[(0,E.jsx)("button",{className:"btn btn-rounded btn-success ms-3 ".concat(z&&"X"!==z?"btn-inactive":""),type:"button",onClick:()=>q("X"),style:{border:"5px solid #afe9f5"},children:" X-Report "}),(0,E.jsx)("button",{className:"btn btn-rounded btn-danger ms-3 ".concat(z&&"Z"!==z?"btn-inactive":""),type:"button",onClick:()=>q("Z"),style:{border:"5px solid #afe9f5"},children:" Z-Report "})]})]})}),(0,E.jsxs)("div",{className:"card-body the-report",style:{display:""===z&&"none",padding:0},children:[(0,E.jsx)("input",{type:"hidden",name:"type",defaultValue:z}),"X"===z&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)("div",{className:"row mb-2",children:[(0,E.jsx)("div",{className:"col-3",children:(0,E.jsx)("label",{htmlFor:"",children:" Today "})}),(0,E.jsx)("div",{className:"col-7",children:(0,E.jsx)("input",{type:"checkbox",name:"today",checked:Z,onChange:()=>B(!Z)})})]}),(0,E.jsxs)("div",{className:"row mb-3",children:[(0,E.jsx)("div",{className:"col-3",style:{alignSelf:"center"},children:(0,E.jsx)("strong",{className:"mt-3",children:" From "})}),(0,E.jsx)("div",{className:"col-9",children:(0,E.jsx)("input",{type:"date",name:"from",className:"form-control",onChange:Y,style:{float:"right"}})})]}),(0,E.jsxs)("div",{className:"row",children:[(0,E.jsx)("div",{className:"col-3",style:{alignSelf:"center"},children:(0,E.jsx)("strong",{className:"mt-3",children:" To "})}),(0,E.jsx)("div",{className:"col-9",children:(0,E.jsx)("input",{type:"date",name:"to",className:"form-control",onChange:Y,style:{float:"right"}})})]})]})]})]})})}),(0,E.jsxs)(R.A,{children:[(0,E.jsx)("button",{type:"button",className:"bg-light btn btn-rounded",onClick:K,children:"Close"}),(0,E.jsx)("button",{className:"bg-info btn text-white btn-rounded",children:" Generate "})]})]})}),(0,E.jsxs)(u.A,{isOpen:N,children:[(0,E.jsx)(h.A,{children:(0,E.jsx)("p",{style:{fontSize:"1.5rem"},children:"Order Details"})}),(0,E.jsx)(g.A,{children:(0,E.jsx)("div",{style:{width:"100%"},children:(0,E.jsxs)("div",{className:"container",style:{backgroundColor:"white",paddingBottom:"10px",borderRadius:"15px",fontSize:"larger"},children:[(0,E.jsx)("div",{style:{display:"flex",fontSize:"larger"},className:"toHide",children:(0,E.jsx)("div",{style:{justifyContent:"center",width:"100%",textAlign:"center",display:"grid"},children:(0,E.jsx)("img",{src:_,alt:"",style:{filter:"grayscale(1)"},height:140})})}),(0,E.jsxs)("div",{style:{marginTop:15},ref:e,children:[(0,E.jsx)("div",{style:{textAlign:"center"},children:(0,E.jsxs)("h5",{style:{textTransform:"uppercase"},children:[(0,E.jsx)("b",{style:{paddingTop:10},children:"\u260e: 070-3563062"}),(0,E.jsx)("br",{}),(0,E.jsx)("span",{children:"\ud83d\uded2"}),"Hobbemaplein 50 ",(0,E.jsx)("br",{})," 2526 JB Den Haag, Netherlands",(0,E.jsx)("br",{})]})}),(0,E.jsxs)("div",{className:"receipt",style:{width:"100%",background:"#fff"},children:[j.map(((e,t)=>(0,E.jsxs)("div",{className:"row",style:V,children:[(0,E.jsxs)("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[(0,E.jsx)("b",{style:{fontSize:e.name.length>35?"medium":"large",fontWeight:900,maxWidth:"80%"},children:e.name}),(0,E.jsx)("strong",{style:{whiteSpace:"nowrap"},children:W+" "+parseFloat(e.prices[e.id]).toFixed(2)})]}),(0,E.jsxs)("div",{className:"toHide",style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[(0,E.jsxs)("p",{style:{fontSize:"large",fontWeight:900,marginTop:"0.5rem"},children:[W+" "+Math.abs(parseFloat(e.prices[e.id]/e.stock).toFixed(2)),"quick"!==e.id?e.units[e.id]?"/ ".concat(e.units[e.id]):"/ Units":null]}),(0,E.jsxs)("p",{style:{fontSize:"medium",fontWeight:900,marginTop:"0.5rem"},children:["Qty: ",e.isVeg?e.stock+e.units[e.id]:parseFloat(e.stock).toFixed(2)]})]})]},t))),(0,E.jsx)("div",{children:(0,E.jsxs)("div",{style:{textAlign:"",marginTop:10},children:[(0,E.jsxs)("h5",{children:[" ",(0,d.x5)(L)," ",W+""+parseFloat(k).toFixed(2)," "]}),(0,E.jsxs)("b",{style:{cssText:"font-size:1.75rem!important;font-weight:600"},children:[" TOTAL \xa0 ",W+" "+parseFloat(k).toFixed(2)]})," ",(0,E.jsx)("br",{})]})})]}),(0,E.jsxs)("div",{style:{width:"100&",textAlign:"center"},children:[(0,E.jsx)("p",{children:"Thank you! Visit Again!"}),(0,E.jsxs)("p",{children:[" ",new Date(x.created_at).toLocaleString()]})]})]})]})})}),(0,E.jsxs)(R.A,{children:[(0,E.jsx)("button",{className:"btn btn-light btn-rounded",onClick:()=>J(!N),children:" Close "}),(0,E.jsx)("button",{type:"button",className:"btn btn-primary btn-rounded",onClick:async t=>{const r=e.current;if(!r)return D.Ay.error("Sorry can't go further...");try{window.electronAPI?window.electronAPI.printContent({html:r.innerHTML,id:x.cash_register_id+":"+T}):(0,d.N5)("Printer not connected!")}catch(n){console.error("Error capturing image:",n)}},children:" Print "})]})]})]})}i().fn.DataTable.ext.errMode="none"},8595:(e,t,r)=>{r.d(t,{C1:()=>d,E2:()=>o,N5:()=>i,Xz:()=>s,Y6:()=>u,f:()=>p,iv:()=>c,sN:()=>l,x5:()=>a});r(8613);var n=r(3768);const s=(e,t)=>{for(var r=e.split(","),n=r[0].match(/:(.*?);/)[1],s=atob(r[r.length-1]),a=s.length,i=new Uint8Array(a);a--;)i[a]=s.charCodeAt(a);return new File([i],t,{type:n})},a=e=>{if(!e)return e;if(e.includes(" ")){let t="";return e.split(" ").forEach((e=>{t+=" "+e.charAt(0).toUpperCase()+e.slice(1)})),t}return e.charAt(0).toUpperCase()+e.slice(1)},i=e=>(0,n.Ay)(e,{icon:"\u26a0\ufe0f",style:{borderRadius:"10px",background:"#333",color:"#fff"}}),o=e=>{if(!e||"object"==typeof e)return e;3===(e=e.replace(/^#/,"")).length&&(e=e.split("").map((e=>e+e)).join(""));return{r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16)}},l=e=>{let t=o(e);if(void 0===t)return e;const{r:r,g:n,b:s}=t;return.299*r+.587*n+.114*s<128};function c(e,t){const r=[];if(!e)return[];arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&e.unshift({});for(let n=0;n<e.length;n+=t)r.push(e.slice(n,n+t));return r}const d=(e,t)=>{if((null===e||void 0===e?void 0:e.length)>t){return e.substring(0,t)+"..."}return e},u=e=>{const t=new Date(e),r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0");String(t.getSeconds()).padStart(2,"0");return"".concat(r,"-").concat(n,"-").concat(s," ").concat(a,":").concat(i)},p=e=>parseFloat(e).toFixed(2)},1939:(e,t,r)=>{e.exports=r.p+"static/media/logo.2d2e09f65e21f53b1f9f.png"}}]);
//# sourceMappingURL=802.2d5283d1.chunk.js.map