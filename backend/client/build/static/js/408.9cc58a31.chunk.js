"use strict";(self.webpackChunkpos=self.webpackChunkpos||[]).push([[408],{3408:(e,t,s)=>{s.r(t),s.d(t,{default:()=>f});var a=s(9379),n=s(9722),d=s(5043),c=s(3003),l=s(3216),r=s(3326),i=s(6221),o=s(591),u=s(782),h=s(9904),x=s(2327),m=s(7550),b=s(7493),j=s(2679),g=s(7877),p=s(1052),y=s(2339),A=s(579);const f=function(){const{type:e}=(0,l.g)(),t=(0,c.wA)(),{data:s,isSuccess:f,refetch:N}=(0,p.$f)(),{data:v,isSuccess:C,refetch:w}=(0,p.bw)(),[k]=(0,p.L0)(),[S,I]=(0,d.useState)([]),[T,D]=(0,d.useState)(!1),[O,L]=(0,d.useState)(!1),P=(0,d.useRef)(null),[G,F]=(0,d.useState)([]),[E,_]=(0,d.useState)({}),[R,V]=(0,d.useState)(e),Q=e=>{e!==R&&V(e)},[H,B]=(0,d.useState)(!1),U=e=>{const{index:t}=e.target.dataset;F(G.map(((s,n)=>n===parseInt(t)?(0,a.A)((0,a.A)({},s),{},{[e.target.name]:e.target.value}):s)))},Y=()=>B(!H),$=e=>_((0,a.A)((0,a.A)({},E),{},{[e.target.name]:e.target.value})),q=e=>{t({type:"LOADING"});const s=S[S.length-1];n.A.post("category/create",s).then((e=>{let{data:t}=e;t.status&&(y.Ay.success("Category added successfully!"),N())})).catch((()=>{})).finally((()=>t({type:"STOP_LOADING"})))},z=(e,s)=>{const{index:a}=s.target.dataset;if(!e)return I(S.filter(((e,t)=>t!==parseInt(a))));window.confirm("Are you sure? Products associated with this category will also be deleted!")&&(t({type:"LOADING"}),n.A.get("category/remove/".concat(e)).then((s=>{let{data:n}=s;n.status?(I(S.filter(((e,t)=>t!==parseInt(a)))),y.Ay.success("Category removed!"),t(p.S5.util.updateQueryData("getPosProducts",void 0,(t=>t.products.filter((t=>t.category_id!==parseInt(e)))))),t(p.S5.util.updateQueryData("getProducts",void 0,(e=>e.products.filter((e=>e.catName!==S[a].name)))))):y.Ay.error("Couldn't remove category!")})).catch((()=>null)).finally((()=>t({type:"STOP_LOADING"}))))},J=e=>{t({type:"LOADING"});const s=G[G.length-1];n.A.post("tax/create",s).then((e=>{let{data:t}=e;t.status?(y.Ay.success("Tax successfully added!"),w()):y.Ay.error("Something went wrong!")})).catch((()=>y.Ay.error("Something went wrong!"))).finally((()=>t({type:"STOP_LOADING"})))},K=(e,s)=>{const{index:a}=s.target.dataset;if(!e)return F(G.filter(((e,t)=>t!==parseInt(a))));window.confirm("Are you sure?")&&(t({type:"LOADING"}),n.A.get("tax/remove/".concat(e)).then((s=>{let{data:n}=s;n.status?(F(G.filter(((e,t)=>t!==parseInt(a)))),y.Ay.success("Tax removed!")):y.Ay.error("Couldn't remove tax!"),t(p.S5.util.updateQueryData("getTaxes",void 0,(t=>t.taxes.filter((t=>t.id!==parseInt(e))))))})).catch((()=>null)).finally((()=>t({type:"STOP_LOADING"}))))},M=e=>{let{index:t}=e.target.dataset;I(S.map(((s,n)=>n===parseInt(t)?(0,a.A)((0,a.A)({},s),{},{[e.target.name]:e.target.value}):s)))},W=async e=>{let{id:t,status:s}=e.target.dataset,a=parseInt(s)?0:1;e.preventDefault();try{(await k({id:t,status:a}).unwrap()).status&&(e.target.checked=a)}catch(n){console.log("Exception on first sight:- "+n.message)}};(0,d.useEffect)((()=>(f&&I(s.categories),()=>null)),[f,s]),(0,d.useEffect)((()=>(C&&F(v.taxes),()=>null)),[C,v]);const X=()=>(0,A.jsx)(r.A,{isOpen:H,toggle:Y,children:(0,A.jsxs)(i.A,{onSubmit:q,children:[(0,A.jsx)(o.A,{toggle:Y,children:" Update Product "}),(0,A.jsx)(u.A,{children:(0,A.jsxs)(h.A,{children:[(0,A.jsx)(x.A,{children:(0,A.jsxs)(m.A,{children:[(0,A.jsx)(b.A,{children:" Name "}),(0,A.jsx)(j.A,{type:"text",name:"name",onChange:$})]})}),(0,A.jsx)(x.A,{children:(0,A.jsxs)(m.A,{children:[(0,A.jsx)(b.A,{children:" Revised Photo "}),(0,A.jsx)(j.A,{name:"color",type:"color",onChange:$})]})}),(0,A.jsx)(x.A,{children:(0,A.jsxs)(m.A,{children:[(0,A.jsx)(b.A,{children:" Status "}),(0,A.jsx)(j.A,{name:"status",type:"checkbox",onChange:$,defaultChecked:!0})]})})]})}),(0,A.jsx)(g.A,{children:(0,A.jsx)("button",{className:"btn btn-primary",type:"button",onClick:Y,children:"Close"})})]})});return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("div",{className:"content-wrapper",children:(0,A.jsxs)("div",{className:"d-grid",style:{overflowY:"auto"},ref:P,children:[(0,A.jsxs)("div",{className:"d-flex position-relative",children:[(0,A.jsx)("button",{className:"btn tablink","data-btn":"category",onClick:()=>Q("categories"),"data-active":"categories"===R,children:" Categories "}),(0,A.jsx)("button",{className:"btn tablink","data-btn":"tax",onClick:()=>Q("taxes"),"data-active":"taxes"===R,style:{borderTopLeftRadius:"0px",borderBottomLeftRadius:"0px"},children:"Taxes"})]}),(0,A.jsx)("div",{id:"category",className:"tabcontent ".concat("categories"===R?"d-block":"d-none"),ref:P,children:(0,A.jsx)("div",{className:"col-lg-12 grid-margin stretch-card",children:(0,A.jsx)("div",{className:"card",children:(0,A.jsx)("div",{className:"card-body",children:(0,A.jsx)("div",{className:"table-responsive w-100 categoryTable",children:(0,A.jsxs)("table",{className:"table table-bordered w-100",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{children:"S.No"}),(0,A.jsx)("th",{children:"Name"}),(0,A.jsx)("th",{children:"Color"}),(0,A.jsx)("th",{children:"Status"}),(0,A.jsxs)("th",{children:["Action",(0,A.jsx)("span",{className:"fa fa-plus btn-sm btn-rounded btn btn-success ms-4",title:"Create",onClick:()=>{I([...S,{name:"",color:"",status:!0}]),P.current&&window.scrollTo(0,document.body.scrollHeight)},children:" New "})]})]})}),(0,A.jsx)("tbody",{children:S.map(((e,t)=>(0,A.jsxs)("tr",{children:[(0,A.jsxs)("td",{children:[" ",1+t," "]}),(0,A.jsxs)("td",{children:[" ",(0,A.jsx)(j.A,{name:"name",type:"text","data-index":t,onChange:M,disabled:e.id&&T!==e.id,defaultValue:e.name})," "]}),(0,A.jsxs)("td",{children:[" ",(0,A.jsx)(j.A,{type:"color",name:"color","data-index":t,onChange:M,disabled:e.id&&T!==e.id,defaultValue:e.color})," "]}),(0,A.jsxs)("td",{children:[(0,A.jsx)("input",{type:"checkbox","data-id":e.id,"data-status":e.status,onChange:W,id:"btn"+e.id,name:"status",defaultChecked:e.status,className:"status"}),(0,A.jsx)("label",{htmlFor:"btn"+e.id}),(0,A.jsx)("div",{className:"plate"})]}),(0,A.jsx)("td",{children:e.id?(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("button",{className:"btn btn-sm btn-primary ".concat(T===e.id&&"btn-success"),onClick:()=>{return T!==e.id?(t=e.id,D(t)):(e=>{const t=S.find((t=>t.id===e));n.A.post("category/update",t).then((e=>{let{data:t}=e;t.status&&(y.Ay.success(t.message),N())})).catch().finally()})(e.id);var t},children:T&&T===e.id?"Save":"Edit"}),(0,A.jsx)("button",{"data-index":t,className:"btn btn-sm btn-danger ms-3 delete",onClick:t=>z(e.id,t),children:"Delete"})]}):(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("button",{className:"btn btn-sm btn-success",onClick:q,children:"Add"}),(0,A.jsx)("button",{"data-index":t,className:"btn btn-sm btn-light ms-3 delete",onClick:t=>z(e.id,t),children:"Cancel"})]})})]},t)))})]})})})})})}),(0,A.jsx)("div",{id:"tax",className:"tabcontent ".concat("taxes"===R?"d-block":"d-none"),children:(0,A.jsx)("div",{className:"col-lg-12 grid-margin stretch-card",children:(0,A.jsx)("div",{className:"card",children:(0,A.jsx)("div",{className:"card-body",children:(0,A.jsx)("div",{className:"table-responsive w-100 taxTable",children:(0,A.jsxs)("table",{className:"table table-bordered w-100",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{children:"S.No"}),(0,A.jsx)("th",{children:"Name"}),(0,A.jsx)("th",{children:"Amount"}),(0,A.jsx)("th",{children:"Status"}),(0,A.jsxs)("th",{children:["Action",(0,A.jsx)("span",{className:"mdi mdi-plus btn-sm btn-rounded btn btn-success ms-4","data-toggle":"modal","data-target":".addTaxes",title:"Create",onClick:()=>{F([...G,{name:"",amount:"",status:!0}]),P.current&&window.scrollTo(0,document.body.scrollHeight)},children:" New "})]})]})}),(0,A.jsx)("tbody",{children:G.map(((e,t)=>(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{children:1+t}),(0,A.jsx)("td",{children:(0,A.jsx)(j.A,{"data-index":t,name:"name",defaultValue:e.name,onChange:U,disabled:e.id&&O!==e.id,className:"input"})}),(0,A.jsx)("td",{children:(0,A.jsx)(j.A,{"data-index":t,name:"amount",defaultValue:e.amount,onChange:U,disabled:e.id&&O!==e.id,className:"input"})}),(0,A.jsxs)("td",{children:[(0,A.jsx)("input",{type:"checkbox",style:{display:"none"},id:"btn-tax"+e.id,name:"status",defaultChecked:e.status,className:"status"}),(0,A.jsx)("label",{htmlFor:"btn-tax"+e.id}),(0,A.jsx)("div",{className:"plate"})]}),(0,A.jsx)("td",{children:e.id?(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("button",{className:"btn btn-sm btn-primary ".concat(O===e.id&&"btn-success"),onClick:()=>{return O!==e.id?(t=e.id,L(t)):(async e=>{const t=G.find((t=>t.id===e)),{data:s}=await n.A.post("/tax/update",t);s.status&&(w(),y.Ay.success("Tax successfully updated!"),L(!1))})(e.id);var t},children:O&&O===e.id?"Save":"Edit"}),(0,A.jsx)("button",{className:"btn btn-sm btn-rounded btn-danger ms-3",onClick:t=>K(e.id,t),children:"Delete"})]}):(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("button",{className:"btn btn-sm btn-rounded btn-success",onClick:J,children:" Add "}),(0,A.jsx)("button",{className:"btn btn-sm btn-rounded btn-light ms-3",onClick:t=>K(e.id,t),children:"Cancel"})]})})]},t)))})]})})})})})})]})}),(0,A.jsx)(X,{})]})}}}]);
//# sourceMappingURL=408.9cc58a31.chunk.js.map