"use strict";(self.webpackChunkpos=self.webpackChunkpos||[]).push([[408],{3408:(e,t,s)=>{s.r(t),s.d(t,{default:()=>N});var a=s(9379),n=s(9722),d=s(5989),c=s.n(d),l=s(5043),r=s(3003),i=s(3216),o=s(7574),u=s(6221),h=s(591),x=s(782),b=s(9904),m=s(2327),p=s(7550),g=s(7493),j=s(2679),y=s(7877),f=s(1052),A=s(3768),v=s(579);const N=function(){var e;const{type:t}=(0,i.g)(),s=(0,r.wA)(),d=(0,l.useRef)(),[N,C]=(0,l.useState)("default"),[k,w]=(0,l.useState)(!1),[S,I]=(0,l.useState)(null),{hasKeyboard:T}=(0,r.d4)((e=>e.auth)),{data:D,isSuccess:O,refetch:L}=(0,f.$f)(),{data:P,isSuccess:E,refetch:F}=(0,f.bw)(),[G]=(0,f.L0)(),[M]=(0,f.Q2)(),[R,z]=(0,l.useState)([]),[_,H]=(0,l.useState)(!1),[Q,Y]=(0,l.useState)(!1),B=(0,l.useRef)(null),[K,U]=(0,l.useState)([]),[V,X]=(0,l.useState)({}),[W,$]=(0,l.useState)(t),q=e=>{e!==W&&$(e)},[J,Z]=(0,l.useState)(!1),ee=e=>{const{index:t}=e.target.dataset;U(K.map(((s,n)=>n===parseInt(t)?(0,a.A)((0,a.A)({},s),{},{[e.target.name]:e.target.value}):s)))},te=()=>Z(!J),se=e=>X((0,a.A)((0,a.A)({},V),{},{[e.target.name]:e.target.value})),ae=e=>{s({type:"LOADING"});const t=R[R.length-1];n.A.post("category/create",t).then((e=>{let{data:t}=e;t.status&&(A.Ay.success("Category added successfully!"),L(),w(""))})).catch((()=>{})).finally((()=>s({type:"STOP_LOADING"})))},ne=(e,t)=>{const{index:a}=t.target.dataset;if(w(null),!e)return z(R.filter(((e,t)=>t!==parseInt(a))));window.confirm("Are you sure? Products associated with this category will also be deleted!")&&(s({type:"LOADING"}),n.A.get("category/remove/".concat(e)).then((t=>{let{data:n}=t;n.status?(z(R.filter(((e,t)=>t!==parseInt(a)))),A.Ay.success("Category removed!"),s(f.S5.util.updateQueryData("getPosProducts",void 0,(t=>t.products.filter((t=>t.category_id!==parseInt(e)))))),s(f.S5.util.updateQueryData("getProducts",void 0,(e=>e.products.filter((e=>e.catName!==R[a].name)))))):A.Ay.error("Couldn't remove category!")})).catch((()=>null)).finally((()=>s({type:"STOP_LOADING"}))))},de=e=>{w(null),s({type:"LOADING"});const t=K[K.length-1];n.A.post("tax/create",t).then((e=>{let{data:t}=e;t.status?(A.Ay.success("Tax successfully added!"),F()):A.Ay.error("Something went wrong!")})).catch((()=>A.Ay.error("Something went wrong!"))).finally((()=>s({type:"STOP_LOADING"})))},ce=(e,t)=>{const{index:a}=t.target.dataset;if(!e)return U(K.filter(((e,t)=>t!==parseInt(a))));window.confirm("Are you sure?")&&(s({type:"LOADING"}),n.A.get("tax/remove/".concat(e)).then((t=>{let{data:n}=t;n.status?(U(K.filter(((e,t)=>t!==parseInt(a)))),A.Ay.success("Tax removed!")):A.Ay.error("Couldn't remove tax!"),s(f.S5.util.updateQueryData("getTaxes",void 0,(t=>t.taxes.filter((t=>t.id!==parseInt(e))))))})).catch((()=>null)).finally((()=>s({type:"STOP_LOADING"}))))},le=e=>{let{index:t}=e.target.dataset;z(R.map(((s,n)=>n===parseInt(t)?(0,a.A)((0,a.A)({},s),{},{[e.target.name]:e.target.value}):s)))},re=async e=>{let{id:t,status:s}=e.target.dataset,a=parseInt(s)?0:1;e.preventDefault();try{(await G({id:t,status:a}).unwrap()).status&&(e.target.checked=a)}catch(n){console.log("Exception on first sight:- "+n.message)}},ie=async e=>{let{id:t,status:s}=e.target.dataset,a=parseInt(s)?0:1;e.preventDefault();try{(await M({id:t,status:a}).unwrap()).status&&(e.target.checked=a)}catch(n){A.Ay.error("Something went wrong!")}};(0,l.useEffect)((()=>(O&&z(D.categories),()=>null)),[O,D]),(0,l.useEffect)((()=>(E&&U(P.taxes),()=>null)),[E,P]);const[oe,ue]=(0,l.useState)(null),[he,xe]=(0,l.useState)({x:window.screen.availWidth/4,y:window.screen.availHeight/2}),[be,me]=(0,l.useState)(!1),[pe,ge]=(0,l.useState)({x:0,y:0}),[je,ye]=(0,l.useState)(""),[fe,Ae]=(0,l.useState)(null!==(e=localStorage.getItem("_keyboard_scale"))&&void 0!==e?e:1),ve=e=>{me(!0),ge({x:e.clientX-he.x,y:e.clientY-he.y})},Ne=e=>{be&&xe({x:e.clientX-pe.x,y:e.clientY-pe.y})},Ce=()=>me(!1);(0,l.useEffect)((()=>{var e;null===(e=d.current)||void 0===e||e.setInput(je)}),[je]);const ke=()=>(0,v.jsx)(o.A,{isOpen:J,toggle:te,children:(0,v.jsxs)(u.A,{onSubmit:ae,children:[(0,v.jsx)(h.A,{toggle:te,children:" Update Product "}),(0,v.jsx)(x.A,{children:(0,v.jsxs)(b.A,{children:[(0,v.jsx)(m.A,{children:(0,v.jsxs)(p.A,{children:[(0,v.jsx)(g.A,{children:" Name "}),(0,v.jsx)(j.A,{type:"text",name:"name",onChange:se})]})}),(0,v.jsx)(m.A,{children:(0,v.jsxs)(p.A,{children:[(0,v.jsx)(g.A,{children:" Revised Photo "}),(0,v.jsx)(j.A,{name:"color",type:"color",onChange:se})]})}),(0,v.jsx)(m.A,{children:(0,v.jsxs)(p.A,{children:[(0,v.jsx)(g.A,{children:" Status "}),(0,v.jsx)(j.A,{name:"status",type:"checkbox",onChange:se,defaultChecked:!0})]})})]})}),(0,v.jsx)(y.A,{children:(0,v.jsx)("button",{className:"btn btn-primary",type:"button",onClick:te,children:"Close"})})]})});return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"content-wrapper",children:(0,v.jsxs)("div",{className:"d-grid",style:{overflowY:"auto"},ref:B,children:[(0,v.jsxs)("div",{className:"d-flex position-relative",children:[(0,v.jsx)("button",{className:"btn tablink","data-btn":"category",onClick:()=>q("categories"),"data-active":"categories"===W,style:{zIndex:8},children:" Categories "}),(0,v.jsx)("button",{className:"btn tablink","data-btn":"tax",onClick:()=>q("taxes"),"data-active":"taxes"===W,style:{borderTopLeftRadius:"0px",borderBottomLeftRadius:"0px",zIndex:8},children:"Taxes"})]}),(0,v.jsx)("div",{id:"category",className:"tabcontent ".concat("categories"===W?"d-block":"d-none"),ref:B,children:(0,v.jsx)("div",{className:"col-lg-12 grid-margin stretch-card",children:(0,v.jsx)("div",{className:"card",children:(0,v.jsx)("div",{className:"card-body",children:(0,v.jsx)("div",{className:"table-responsive w-100 categoryTable",children:(0,v.jsxs)("table",{className:"table table-bordered w-100",children:[(0,v.jsx)("thead",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{children:"S.No"}),(0,v.jsx)("th",{children:"Name"}),(0,v.jsx)("th",{children:"Color"}),(0,v.jsx)("th",{children:"Status"}),(0,v.jsxs)("th",{children:["Action",(0,v.jsx)("span",{className:"fa fa-plus btn-sm btn-rounded btn btn-success ms-4",title:"Create",onClick:()=>{z([...R,{name:"",color:"",status:!0}]),B.current&&window.scrollTo(0,document.body.scrollHeight)},children:" New "})]})]})}),(0,v.jsx)("tbody",{children:R.map(((e,t)=>(0,v.jsxs)("tr",{children:[(0,v.jsxs)("td",{children:[" ",1+t," "]}),(0,v.jsxs)("td",{children:[" ",(0,v.jsx)(j.A,{name:"name",type:"text","data-index":t,onChange:le,disabled:e.id&&_!==e.id,value:e.name,onClick:s=>{w("name"),ue("cat"),ye(e.name),I(t)}})," "]}),(0,v.jsxs)("td",{children:[" ",(0,v.jsx)(j.A,{type:"color",name:"color","data-index":t,onChange:le,disabled:e.id&&_!==e.id,defaultValue:e.color})," "]}),(0,v.jsxs)("td",{children:[(0,v.jsx)("input",{type:"checkbox","data-id":e.id,"data-status":e.status,onChange:re,id:"btn"+e.id,name:"status",defaultChecked:e.status,className:"status"}),(0,v.jsx)("label",{htmlFor:"btn"+e.id}),(0,v.jsx)("div",{className:"plate"})]}),(0,v.jsx)("td",{children:e.id?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("button",{className:"btn btn-sm btn-primary ".concat(_===e.id&&"btn-success"),onClick:()=>{return _!==e.id?(t=e.id,H(t)):(e=>{const t=R.find((t=>t.id===e));n.A.post("category/update",t).then((e=>{let{data:t}=e;t.status&&(A.Ay.success(t.message),H(""),w(null),L())})).catch().finally()})(e.id);var t},children:_&&_===e.id?"Save":"Edit"}),(0,v.jsx)("button",{"data-index":t,className:"btn btn-sm btn-danger ms-3 delete",onClick:t=>ne(e.id,t),children:"Delete"})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("button",{className:"btn btn-sm btn-success",onClick:ae,children:"Add"}),(0,v.jsx)("button",{"data-index":t,className:"btn btn-sm btn-light ms-3 delete",onClick:t=>ne(e.id,t),children:"Cancel"})]})})]},t)))})]})})})})})}),(0,v.jsx)("div",{id:"tax",className:"tabcontent ".concat("taxes"===W?"d-block":"d-none"),children:(0,v.jsx)("div",{className:"col-lg-12 grid-margin stretch-card",children:(0,v.jsx)("div",{className:"card",children:(0,v.jsx)("div",{className:"card-body",children:(0,v.jsx)("div",{className:"table-responsive w-100 taxTable",children:(0,v.jsxs)("table",{className:"table table-bordered w-100",children:[(0,v.jsx)("thead",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{children:"S.No"}),(0,v.jsx)("th",{children:"Name"}),(0,v.jsx)("th",{children:"Amount"}),(0,v.jsx)("th",{children:"Status"}),(0,v.jsxs)("th",{children:["Action",(0,v.jsx)("span",{className:"mdi mdi-plus btn-sm btn-rounded btn btn-success ms-4","data-toggle":"modal","data-target":".addTaxes",title:"Create",onClick:()=>{U([...K,{name:"",amount:"",status:!0}]),B.current&&window.scrollTo(0,document.body.scrollHeight)},children:" New "})]})]})}),(0,v.jsx)("tbody",{children:K.map(((e,t)=>(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{children:1+t}),(0,v.jsx)("td",{children:(0,v.jsx)(j.A,{"data-index":t,name:"name",value:e.name,onChange:ee,disabled:e.id&&Q!==e.id,className:"input",onClick:s=>{w("name"),ue("ct"),ye(e.name),I(t)}})}),(0,v.jsx)("td",{children:(0,v.jsx)(j.A,{"data-index":t,name:"amount",defaultValue:e.amount,onChange:ee,disabled:e.id&&Q!==e.id,className:"input",onClick:s=>{w("amount"),ue("ct"),ye(e.amount),I(t)}})}),(0,v.jsxs)("td",{children:[(0,v.jsx)("input",{type:"checkbox",style:{display:"none"},id:"btn-tax"+e.id,name:"status","data-id":e.id,"data-status":e.status,defaultChecked:e.status,className:"status",onChange:ie}),(0,v.jsx)("label",{htmlFor:"btn-tax"+e.id}),(0,v.jsx)("div",{className:"plate"})]}),(0,v.jsx)("td",{children:e.id?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("button",{className:"btn btn-sm btn-primary ".concat(Q===e.id&&"btn-success"),onClick:t=>{var s;Q!==e.id?(s=e.id,Y(s)):(async e=>{const t=K.find((t=>t.id===e)),{data:s}=await n.A.post("/tax/update",t);s.status?(F(),A.Ay.success("Tax successfully updated!"),Y(!1)):A.Ay.error("Failed to update tax, try creating new one deleting it."),w(null)})(e.id)},children:Q&&Q===e.id?"Save":"Edit"}),(0,v.jsx)("button",{className:"btn btn-sm btn-rounded btn-danger ms-3",onClick:t=>ce(e.id,t),children:"Delete"})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("button",{className:"btn btn-sm btn-rounded btn-success",onClick:de,children:" Add "}),(0,v.jsx)("button",{className:"btn btn-sm btn-rounded btn-light ms-3",onClick:t=>ce(e.id,t),children:"Cancel"})]})})]},t)))})]})})})})})})]})}),(0,v.jsx)(ke,{}),k&&!T&&(0,v.jsx)("div",{className:"mt-4 position-fixed w-50",style:{zIndex:9999,top:60},children:(0,v.jsx)("div",{style:{overflow:"hidden",position:"relative",touchAction:"none"},onMouseMove:Ne,onTouchMove:Ne,onMouseUp:Ce,onTouchEnd:Ce,children:(0,v.jsxs)("div",{style:{position:"fixed",top:"".concat(he.y,"px"),left:"".concat(he.x,"px"),cursor:be?"grabbing":"grab",zIndex:1e3,width:700,resize:"both",overflow:"auto",touchAction:"none",transform:"scale(".concat(fe,")"),transformOrigin:"top center"},children:[(0,v.jsx)("div",{onMouseDown:ve,onTouchStart:ve,style:{background:"#444",color:"#fff",padding:10,cursor:"grab",textAlign:"center",touchAction:"none",borderRadius:"8px 8px 0 0"},children:"Hold To Drag"}),(0,v.jsx)(c(),{onChange:e=>{"cat"===oe?z(R.map(((t,s)=>s===parseInt(S)?(0,a.A)((0,a.A)({},t),{},{[k]:e}):t))):U(K.map(((t,s)=>s===parseInt(S)?(0,a.A)((0,a.A)({},t),{},{[k]:e}):t)))},onKeyPress:e=>{"{lock}"===e&&C((e=>"default"===e?"shift":"default"))},keyboardRef:e=>d.current=e,layout:{default:"amount"===k?["! @ # $ % ^ & * {bksp}","1 2 3 4 5 6 7 8 9 0"]:["1 2 3 4 5 6 7 8 9 0","q w e r t y u i o p","{lock} a s d f g h j k l","z x c v b n m {bksp}","{space}"],shift:["1 2 3 4 5 6 7 8 9 0","Q W E R T Y U I O P","{lock} A S D F G H J K L","Z X C V B N M {bksp}","{space}"]},display:{"{lock}":"Caps","{bksp}":"Backspace","{space}":"Space"},layoutName:N}),(0,v.jsxs)("div",{className:"bg-white d-flex board-navs",style:{justifyContent:"space-between",padding:"5px 20px"},children:[(0,v.jsx)("button",{className:"btn btn-light btn-rounded",onClick:()=>{d.current.clearInput()},style:{border:"1px solid gray"},children:"CLEAR"}),(0,v.jsx)("button",{style:{border:"1px solid"},className:"btn btn-light btn-rounded",onClick:()=>Ae((e=>Math.max(e-.1,.5))),children:"-"}),(0,v.jsxs)("span",{style:{placeContent:"center"},children:[" Size: ",Math.round(100*fe),"% "]}),(0,v.jsx)("button",{style:{border:"1px solid"},className:"btn btn-light btn-rounded",onClick:()=>Ae((e=>Math.min(e+.1,2))),children:"+"}),(0,v.jsx)("button",{onClick:()=>w(""),className:"btn btn-light btn-rounded",style:{border:"1px solid gray"},children:"HIDE"})]})]})})})]})}}}]);
//# sourceMappingURL=408.49a58ef3.chunk.js.map